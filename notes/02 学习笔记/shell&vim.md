# shell&vim
<!-- GFM-TOC -->
* [shell 编程](#shell-编程)
	* [变量](#变量)
	* [注释](#注释)
	* [字符串](#字符串)
	* [shell数组](#shell数组)
	* [传递参数](#传递参数)
	* [shell基本运算符](#shell基本运算符)
		* [关系运算符](#关系运算符)
		* [逻辑运算符](#逻辑运算符)
	* [printf](#printf)
	* [流程控制](#流程控制)
		* [if 语句](#if-语句)
		* [for 循环](#for-循环)
		* [while 语句](#while-语句)
		* [case](#case)
* [vim](#vim)
	* [特殊符号](#特殊符号)
	* [翻页](#翻页)
	* [插入](#插入)
	* [移动](#移动)
	* [打开文件](#打开文件)
	* [退出](#退出)
	* [查找](#查找)
	* [替换](#替换)
	* [撤销和重做](#撤销和重做)
	* [删除](#删除)
	* [拷贝与粘贴](#拷贝与粘贴)
	* [其他](#其他)
	* [visual 模式](#visual-模式)
* [Tmux](#Tmux)
	* [会话](#会话)
	* [窗口](#窗口)
	* [面板](#面板)
* [linux 命令行快捷键](#linux-命令行快捷键)
<!-- GFM-TOC -->

## shell 编程
开头： ```#! /bin/bash```
语句可以写在一行，用分号隔开。

### 变量
定义变量，赋值等号无空格 ```name=xieyiyu```  
使用变量，用 '$' , ```echo $name```  
最好给变量添加花括号，帮助识别变量边界 ```echo "my name is ${name}, hello"```  
只读变量， ```readonly name```
删除变量， unset， 但不能删除只读变量

### 注释
注释 '#'  
多行注释
```sh
:<<EOF
注释内容
EOF
```

### 字符串
单引号 ' ' ： 所有的都当做普通字符，变量无效，转义无效，单引号中不能再出现单引号
双引号 " " ： $ \ \` 三个仍为特殊字符， 双引号中可以出现转义后的双引号

字符串长度 `length=${#name}`  
提取子字符串 `echo ${name:1:2}` 字符串下标从 0 开始  
查找子字符串， 如查找 $name 中 y 出现的位置， echo \`expr index "$name" y\` 返回下标   

### shell数组
用括号表示数组，元素用空格分割 `name=(xieyiyu Tom Mary)`  
单独定义，可以不使用连续下标，且下标范围无限制 `name[1]=Jack`  
读取数组，`myname=${name[0]}`  
@ 可以获取数组所有元素， `allname=${name[@]}`  
获取数组长度 `name_length=${#name[@]}`  

### 传递参数
$0 为执行的文件名，之后 $1,...,$n 表示第 n 个参数

### shell基本运算符
expr 表达式计算工具，可以完成表达式的求值操作，注意使用反引号
```sh
var=`expr 2 + 2` # 注意表达式和运算符之间要有空格
echo $var # 4
```

条件表达式要放在方括号之间，并且必须要有空格，如 `if [ $a == $b ]`

#### 关系运算符
```
-ne 相当于 !=
-gt 相当于 >
-lt 相当于 <
-ge 相当于 >=
-le 相当于 <=
```

#### 逻辑运算符
```
&& 逻辑 AND
|| 逻辑 OR
```

### printf
`printf format-string [arguments...]`
如： `printf "%-10s %-8s %-4.2f\n" Mary Female 46.6789`

%s(String) %c(Char) %d(十进制整数) %f(Float) 都是格式替代符

%-10s 指一个宽度为 10 个字符（ - 表示左对齐，没有则表示右对齐），任何字符都会被显示在 10 个字符宽的字符内，如果不足则自动以空格填充，超过也会将内容全部显示出来。

%-4.2f 指格式化为小数，其中 .2 指保留 2 位小数。

### 流程控制
#### if 语句
```sh
a = 10
b = 20
if [ $a == $b ]
then 
	echo "a 等于 b"
elif [ $a -gt $b ]
then
	echo "a 大于 b"
else
	ehco "a 小于 b"
fi
```

#### for 循环
数字循环
```sh
for((i=1;i<=10;i++));do
	echo $i
done
```

列表循环
```sh
for var in item1 item2 ... itemN
do
	command
done
```

#### while 语句
```sh
int=1
while(( $int<=5 ))
do
	echo $int
	let "int++" # let 执行一个或多个表达式，变量计算不需要加 $
done
```

#### case
```sh
case $aNum in
    1)  echo '你选择了 1'
    ;;
    2)  echo '你选择了 2'
    ;;
    3)  echo '你选择了 3'
    ;;
    4)  echo '你选择了 4'
    ;;
    *)  echo '你没有输入 1 到 4 之间的数字'
    ;;
esac
```

#### 跳出循环
break 和 continue

## vim
#### 特殊符号
% 指明操作区间为全文本，也可以是 1,$,行区间

#### 翻页
```
ctrl + f ： 向前翻一页  
ctrl + b ： 向后翻一页
```

#### 插入
```
o 在当前行后插入一个新行
cw 替换从光标所在位置后到一个单词结尾的字符
```

#### 移动
```
gg ： 光标移动到文档开头
G : 光标移动到文档末尾
:n(行号) 移动到第 n 行开头
w 向前移动一个单词， nw（n为数字）
b 向后移动一个单词， nb
0 移动到本行第一个字符上
^ 移动到本行第一个非空白字符上
$ 移动到行尾
fx 找到光标后第一个为 x 的字符
```

**重要：**
```
% 匹配括号移动，包括 (,{,[ ，光标需要先移动到括号上
* 和 # 匹配光标当前所在的单词，* 移动到下一个匹配单词， # 移动到上一个匹配单词
```

#### 打开文件
```
vim file1 file2 file3... 同时打开多个文件
:e <filepath> 打开一个文件
:bn 切换到下一个文件
:bp 切换到上一个文件
:args 查看当前打开的文件列表
```

#### 退出
```
:e! 放弃所有修改，从上次保存文件开始再编辑命令历史
```

#### 查找
```
/pattern 按 n 查找下一个，N 查找上一个
:%s/pattern//gn 统计当前文本中 pattern 的出现次数
:k,ls/pattern//gn 统计文本 k 行到 l 行中 pattern 的出现次数
```

#### 替换
```
s/old/new/g 用 old 替换 new，替换当前行的所有匹配
%s/old/new/g 用 old 替换 new，替换整个文件的所有匹配
ddp 交换光标所在行和其下紧邻的一行
```

#### 撤销和重做
```
u 撤销
U 撤销对整行的操作
ctrl + r 重做，即撤销的撤销
```

#### 删除
```
dd 删除当前行
10d 删除当前行开始的 10 行
x 删除当前字符
3x 删除当前光标开始向后的三个字符
D 删除当前字符至行尾
```

### 拷贝与粘贴
```
yy 拷贝当前行
3yy 拷贝当前行和后面两行
p 在当前光标后粘贴，若之前使用了 yy 拷贝一行，则在当前行的下一行粘贴
ddp 交换当前行和其下一行
```

### 其他
```
. 重复上一次命令
N<command> 重复 N 次某个命令
```
### visual 模式
```
v 逐个字符选择文本
V 逐行选择文本
```
可视化模式中选择的区域是由左上角和右上角两个端点来界定的，通过```o```可以切换左上角和右下角。


## Tmux
[Tmux 快捷键&速查表](#https://gist.github.com/ryerh/14b7c24dfd623ef8edc7)

tmux 采用 C/S 模型，输入 tmux 命令就相当于开启了一个服务器，此时默认新建一个会话 session，会话中会默认新建一个窗口 window， 窗口中默认新建一个面板 pane。 一个 session 可以包含多个 window，一个 window 可以包含多个 pane。

window 可以运行相关性不大的任务； pane 适合运行相关性高的任务，以便同时观察其运行情况。

### 会话
新建会话：
```sh
tmux new -s 会话名
```
恢复会话：
```sh
tmux at -t 会话名
```
列出所有会话：
```sh
tmux ls
```
关闭会话：
```sh
tmux kill-session -t 会话名
```

kill 命令有 kill-server, kill-session, kill-windows 和 kill-pane 四种
```sh
tmux kill-server 关闭服务器，所有的会话都会关闭
```

进入 tmux 后，所有的操作都需要按下 tmux 前缀， **ctrl + b**， 再进行其他操作

```
d    断开当前会话，但不是 kill，使用 tmux at -t 会话名可以再次进入
$    重命名当前会话
s    列出所有会话
```

### 窗口
```
c    创建新窗口
0-9  切换到指定窗口
&    关闭当前窗口
,    重命名当前窗口
.    修改当前窗口编号（适用于窗口重新排序）
w    列出所有窗口
```

### 面板
```
%    垂直(左右)分割，在右侧新建面板
"    水平(上下)分割，在下侧新建面板
x    关闭当前面板
z    切换面板最大化/最小化
!    将当前面板移动到新窗口中打开
q    显示当前窗口中每个面板的编号，在编号消失前输入对应数字即可切换到相应的面板
{    与上一个面板交换位置
}    与下一个面板交换位置

方向键         切换面板
ctrl+方向键    以 1 个单元格为单位调整当前面板边缘
```

### 命令模式
prefix + :    进入命令模式

### 开启鼠标
在 tmux v2.1	 及以上版本，仅需加入配置：
```sh
set-option -g mouse on # 开启鼠标
set-option -g mouse off # 关闭鼠标，此时可以直接复制粘贴
```
需要注意的是： 开启鼠标支持后，iTem2 默认的鼠标选中即复制功能需要同时按下 Alt 键

### 修改配置
tmux 提供了灵活的配置性，用户可以为 tmux 命令绑定自己习惯的指令。

tmux 的用户级配置文件为 `~/.tmux.conf`， 比如想要修改前缀 ctrl+b 为 ctrl+a，可以修改配置文件

```sh
set -g prefix C-a
unbind C-b # 解除绑定 ctrl+b
bind C-a send-prefix # 绑定 ctrl+a 为新的前缀指令
```

修改配置文件后，在命令模式下输入： `source-file ~/.tmux.conf`，回车后生效。

## linux 命令行快捷键
### 常用
```
ctrl+左右键:在单词之间跳转
ctrl+a:跳到本行的行首
ctrl+e:跳到页尾
ctrl+u：删除当前光标前面的文字 (还有剪切功能)
ctrl+k：删除当前光标后面的文字 (还有剪切功能)
Ctrl+L：进行清屏操作
```