# Linux
<!-- GFM-TOC -->
* [文件](#文件)
	* [文件与目录基本操作](#文件与目录基本操作)
	* [文件权限](#文件权限)
* [linux 三剑客](#linux-三剑客)
* [进程管理](#进程管理)
	* [查看进程](#查看进程)
	* [后台运行](#后台运行)
	* [孤儿进程和僵尸进程](#孤儿进程和僵尸进程)
* [系统管理](#系统管理)
	* [用户管理](#用户管理)
* [shell](#shell)
* [其他](#其他)
<!-- GFM-TOC -->

## 文件管理
### 文件与目录基本操作
#### 1. ls
```html
$ ls [-alrtAFR] file|dir
-a 显示所有文件及目录，以'.'开头的不会列出
-l 长模式输出，显示详细信息
-r 相反顺序显示
-t 按照文件修改时间先后排序
```
列出当前目录下所有名称是 s 开头的文件，新的排在后面
```sh
$ ls -ltr s*
```

#### 2. 目录
- mkdir [-mp] dirname 创建目录
- rmdir [-p] dirname 删除目录，只能删除空目录
- pwd 查看当前所在目录，输出绝对路径

-m 配置目录权限；   
-p 递归创建/删除目录。 创建时确保目录名称存在，不存在的就建一个；删除时当子目录被删除后使它也成为空目录的话，则顺便一并删除

#### 3. touch
修改文件时间信息，或新建文件

#### 4. rm
删除文件或目录，使用 rm 删除成功则无法恢复
```html
$ rm [-ir] file|dir
-i 删除前逐一询问
-r 删除目录及里面的文件，目录必须用次参数
```

#### 5. cp
复制文件或目录
```html
$ cp [options] sourcedir destdir
-a 常用于复制目录，保留链接、文件属性，并复制目录下所有文件
-d 复制时保留链接，链接相当于 win 中的快捷方式
-f 覆盖已存在的目标文件且不提示
-i 覆盖已存在的目标文件前，给与提示
-u 仅复制目标目录中不存在的或是文件内容更新的文件
```

#### 6. mv
移动目标文件 mv [-fi] sourcedir destdir

#### 7. file
确定文件类型

#### 8. less
浏览文件内容,可一页一页显示输出

#### 9. ln
为某文件在另外的位置建立一个同步的链接，不会重复占用磁盘空间
http://www.runoob.com/linux/linux-comm-ln.html
- 硬链接
- 软连接
ln：创建硬链接和符号链接； ln -s 文件名 链接名：符号链接

#### 10. cat
显示文件内容并输出
```html
-n 从 1 开始对输出行进行编号
-b 也是编号，但是空白行不编号
```
把 text1 的文档内容加上行号后输入到 text2 中
```sh
$ cat -n text1 > text2
```

### 文件权限
rwx； x：可执行
十个字符；第一个表文件类型，- 普通文件，d 目录；c 字符设备文件， b块设备文件；l 符号链接，权限是虚拟的，真是权限为指向的文件，一直是lrwxrwxrwx
后面分别为owner，group， world的权限

#### 1.chmod
修改文件或目录权限 chmod [options] mode file

mode: 权限设置字串，格式为 [ugoa][+-=][rwxX][...]
```
u：文件所有者； g：用户组； o：其他所有人； a：all
+：增加权限； -：取消权限； =：设定唯一权限
```

将文件 file1 与 file2 设为该文件拥有者，与其所属同一个群体者可写入，但其他以外的人则不可写入 
```sh
$ chmod ug+w,o-w file1 file2
```

#### 2. chown
修改文件的属主，可改为其他用户或群组 chown [options] user[:group] file

将文件 file 的所有者设为  users 群组中的 tom 用户
```sh
$ chown tom:users file
```

#### 3. chgrp
修改文件或目录的所属群组
chgrp [options] [所属群组] [file/dir]


## linux 三剑客
### 1. grep
grep : 作用 文本搜索工具，根据用户指定的‘模式’（可以是正则表达式）对目标文件逐步进行匹配检查，打印匹配到的行

grep [options] 字符串 [filepath]

-c 显示符合要求的个数； 
-i 忽略大小写；
-n 输出行号；
 -v 反向输出，也就是不匹配的内容； 
 -o 只显示被匹配到的字符串；

### 2. awk
用于处理数据和生成报告，更适合文本格式化，对文本进行较复杂的格式处理。

awk [options] 'pattern{action}' filepath

awk 逐行处理文本，处理的最小单位是字段，每个字段的命名方式为：$n，n 为字段号，从 1 开始，$0 表示一整行。

pattern 包含两种特殊模式， BEGIN 模式是命令在处理文本之前执行， END 模式是命令在处理文本之后执行。

查看最近 5 条登录用户和 ip 地址
```sh
$ last -n 5 | awk '{print $1"\t"$3}'
```

### 3. sed
文本编辑工具，实现数据的替换，删除，增加，选取等(以行为单位进行处理)

## 进程管理
### 查看进程
#### 1. ps
空 显示自己的进程；
-a 显示现行终端下的所有进程，包括其他用户的进程；
-A 所有进程都显示，相当于 -e；
-u 以用户为主的进程状态；
x 通常与 -a 一起用，列出较完整的信息；
-l 显示较详细的信息

查看系统所有进程
```sh
$ ps aux
```
查看特定进程
```sh
$ ps aux | grep xxx
```

#### 2. pstree
显示进程树，即用树状图形式显示进程。 -p 显示 pid

#### 3. top
实时显示进程信息，可用于监控 linux 的系统状况

#### 4. netstat
显示各种网络相关信息，如网络连接、路由表、接口状态等。

-a 显示所有选项（包括 listen）；
-t 仅显示 tcp 相关； 
-u 仅显示 udp 相关；
-l 仅列出有在 listen 的服务状态；
-n 拒绝显示别名（显示数字）；
-p 显示建立相关连接的程序名

查看占用 80 端口的进程信息
```sh
$ netstat -anp | grep 80
```

### 后台运行
&：命令后加&，后台运行
bg %1 ： 将1号进程移到后台； fg %1：移到前台

### 孤儿进程和僵尸进程
子进程和父进程的运行是异步过程，即父进程永远无法预测子进程何时结束。当子进程完成工作终止后，父进程需要调用 wait() 或 waitpid() 系统取得子进程的终止状态。

#### 孤儿进程
- 一个父进程退出，而他的子进程还在运行，那么这些子进程将成为孤儿进程。
- 孤儿进程没有父进程，会被 init 进行（pid=1）收养，并由 init 进程对他们完成状态收集工作。 
- 孤儿进程不会对系统造成危害。

#### 僵尸进程
- 一个进程使用 fork 创建子进程，如果子进程退出，而父进程没有调用 wait() 或 waitpid() 获取子进程的状态信息，那子进程的进程描述符仍保留在系统中，成为僵尸进程。
- 子进程在 exit() 后并非马上消失，而是留下一个僵尸进程(zombie)的数据结构，等待父进程处理。若父进程没来得及处理，用 ps 查看子进程会显示状态 “Z”
- 系统能使用的进程号有限，如果产生大量僵尸进程，就可能因为没有可用进程号而不能产生新进程。
- 消灭僵尸进程： kill 父进程，那僵尸进程将变为孤儿进程，由 init 收养，init 会释放僵尸进程占用的资源。

### 系统管理
#### 用户管理
useradd xxx：添加用户
passwd xxx： 为新用户设置密码
userdel xxx：删除用户
logout：注销当前用户

### shell
echo $((5 ** 2))  //25: 显示算术表达式结果， ** 为幂运算
花括号 { }展开： 可以创建一系列文件或目录列表；mkdir 2017-0{1..9} 2017-{10,11,12}
单引号 ' ' ： 所有的都当做普通字符
双引号 " " ： $ \ \` 三个仍为特殊字符






### 过滤器
sort： 可以改变输出结果，生成一个有序列表
uniq： 报道或忽略重复行，接受数据有序列表，常与sort连用; 输出重复的行，加上 -d
如 ls /bin /usr/bin | sort | uniq | less
wc： 显示文件包含的行数、字数和字节数； wc -l ：只显示行数
head/tail ： 默认打印文件开头/结尾的十行； -n x：控制打印x行； -f：检测文件变化，有新内容会显示在屏幕上



wget 地址：下载文件
tar -zxvf xxx：解压； ./configure ； make ； make install
tough filename：新建文件；vi filename：新建并编辑

linux字符类 [:alnum:] 任意一个字母或数字; [:alpha:]; [:digit:]; [:lower:]; [:upper:]
例： \*[[:lower:]123] 文件名以小写字母结尾，或以1 2 3结尾的文件
两次tab键 ： 显示自动补全列表
history：显示历史命令； history | grep /usr/bin ： 显示包含/usr/bin的历史命令

~ ： 显示目录

ctrl+a ： 光标移到行首； ctrl+e ： 光标移到行尾
文本编辑
ctrl+d ： 删除光标位置的字符

